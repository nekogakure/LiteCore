この章では、シェルの入出力とインタラクティブ機能について記述します。
実装されているファイルは[shell.c](https://github.com/nekogakure/LiteCore/blob/main/src/kernel/shell/shell.c), [shell.h](https://github.com/nekogakure/LiteCore/blob/main/src/include/shell/shell.h)です。

## 概要
シェルのインタラクティブな入出力機能を提供します。ユーザー入力の読み取り、バッファ管理、プロンプト表示、バックスペース処理などを実装します。

## 関数 / API

#### `void init_shell(void)`
シェルを初期化します。ウェルカムメッセージを表示し、コマンドシステムと組み込みコマンドを初期化し、プロンプトを表示します。

引数: なし

#### `void shell_run(void)`
シェルのメインループ（ブロッキング版）です。キーボードからの入力を待ち、1文字ずつ処理します。

引数: なし

#### `int shell_readline_and_execute(void)`
1行のコマンドを読み取って実行します（ポーリング版）。キーボードから文字を取得し、処理します。

引数: なし

戻り値: コマンドが実行された場合1、そうでなければ0

## 定数 / 定義

- `SHELL_BUFFER_SIZE`: 256 - シェル入力バッファのサイズ

## 構造体

このファイルには公開構造体の定義はありません。

## 実装の詳細

### 入力バッファ管理
静的な入力バッファ（256バイト）を使用して、ユーザーの入力を保存します。バッファ位置（`buffer_pos`）で現在の入力位置を追跡します。

### プロンプト表示
`show_prompt()`関数は、現在のディレクトリ名を含むプロンプトを表示します。フォーマットは`LiteCore@<directory> $ `です。ルートディレクトリの場合は`LiteCore@/ $ `と表示します。

### 文字処理
`process_char()`関数は、入力された文字を処理します：

- **Enter (\\n, \\r)**: コマンドを実行し、バッファをクリアし、新しいプロンプトを表示
- **Backspace (\\b, 0x08, 127, 0x7F)**: バッファから1文字削除し、画面からも削除
- **Tab (\\t)**: 現在は無視（将来の補完機能用に予約）
- **ESC (27)**: 無視
- **表示可能文字 (32-126)**: バッファに追加し、画面に表示
- **その他の制御文字**: 無視

### ポーリング vs ブロッキング
- `shell_readline_and_execute()`: ポーリング版。`keyboard_getchar_poll()`を使用。メインループから定期的に呼び出される
- `shell_run()`: ブロッキング版。`keyboard_getchar()`を使用。入力があるまで待機

### バッファオーバーフロー保護
入力が256文字に達した場合、それ以上の文字は無視されます。
