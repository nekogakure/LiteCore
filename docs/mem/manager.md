この章では、メモリ管理（ヒープおよびメモリマップ初期化）に関する実装について記述します

## 概要
メモリ管理の実装されているファイルは`mem/manager.c`です。
このファイルでは、ヒープ領域を用いた動的メモリアロケータ（`kmalloc` / `kfree`）や、メモリマップの初期化、スタック領域の確保機能などを実装しています。
アロケータはシンプルな**フリーリスト方式**を採用しており、割り込みコンテキストでも安全に利用できるようにスピンロックで排他制御されています。

## API

### 定義されている定数
- `ALIGN`: ヒープアロケータのアライメント単位（8バイト）

### 関数

- **`mem_init`** -> void
  - **引数**:
    -  (uint32_t) `start`: ヒープ領域の開始アドレス
    -  (uint32_t) `end`: ヒープ領域の終了アドレス
  - 指定された範囲をヒープ領域として初期化します。最初のフリーブロックを作成します

- **`kmalloc`** -> void*（割り当てた領域のアドレス。空きがなければNULL）
  - **引数**:
    - (uint32_t) `size`: 確保するメモリサイズ（バイト単位）
  - ヒープから指定サイズのメモリを確保します。必要に応じてブロックを分割します。

- **`kfree`** -> void
  - **引数**:
    - (void*) `ptr`: 解放するメモリ領域へのポインタ
  - `kmalloc`で確保したメモリを解放します。隣接ブロックが空きなら自動的に併合されます。

- **`mem_has_space`** -> int（1=空きあり / 0=空きなし）
  - **引数**:
    - (mem_type_t) `type`: メモリタイプ（`MEM_TYPE_HEAP` または `MEM_TYPE_FRAME`）
    - (uint32_t) `size`: 確保したいサイズ（バイト単位）
  - 指定したタイプのメモリに、連続した`size`バイト分の空きがあるかを判定します。

- **`memory_init`** -> void
  * 物理メモリマップ（`memmap`）を初期化し、ヒープ領域を設定します。
    カーネル終了位置やメモリマップビットマップ領域を考慮し、64KBのヒープを構築します。

- **`stack_alloc`** -> void*（スタックのトップアドレス）
  - **引数**:
    - (uint32_t) `size`: スタック領域のサイズ（バイト単位）
  - 下方向に伸びるスタックを確保します。返り値はスタックのトップ（高位アドレス側）です。

- **`stack_free`** -> void
  - **引数**:
    - (void*) `top`: `stack_alloc`で返されたスタックのトップ
    - (uint32_t) `size`: 元の要求サイズ
  - `stack_alloc`で確保したスタック領域を解放します。
