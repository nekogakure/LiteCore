この章では、コンソール出力機能について記述します。
実装されているファイルは[console.c](https://github.com/nekogakure/LiteCore/blob/main/src/kernel/util/console.c), [console.h](https://github.com/nekogakure/LiteCore/blob/main/src/include/util/console.h)です。

## 概要
コンソールモジュールは、VGAテキストモード（80x25）でのテキスト出力を管理します。カーソル位置の追跡、スクロール、履歴バッファ、printk形式の出力をサポートします。シリアルポート出力にも対応しています。

## 関数 / API

#### `void console_init()`
コンソールを初期化します。画面をクリアし、カーソル位置と履歴をリセットします。

引数: なし

#### `void new_line()`
改行を行います。必要に応じてスクロールし、履歴バッファに行を保存します。

引数: なし

#### `int printk(const char *fmt, ...)`
フォーマット文字列を使用してコンソールに出力します。printf形式の書式指定をサポートします。

引数:
  - fmt(const char*): フォーマット文字列
  - ...: 可変長引数

戻り値: 出力した文字数

#### `void console_scroll_page_up(void)`
コンソールを1ページ上にスクロールします（履歴を表示）。

引数: なし

#### `void console_scroll_page_down(void)`
コンソールを1ページ下にスクロールします（現在の出力に戻る）。

引数: なし

## 定数 / 定義

- `CONSOLE_COLS`: 80 - コンソールの列数
- `CONSOLE_ROWS`: 25 - コンソールの行数
- `N_HISTORY`: 100 - 履歴バッファに保存する最大行数

## 構造体

このファイルには公開構造体の定義はありません。

### 内部実装

- **カーソル位置**: `cursor_row`と`cursor_col`で管理
- **VGAテキストメモリ**: 0xB8000番地から始まる80x25文字のバッファ
- **履歴バッファ**: 最大100行の過去の出力を保存
- **スクロール**: 画面が満杯になると自動的にスクロール

### VGAテキストモード

各文字は2バイトで表現されます：
- バイト0: ASCII文字コード
- バイト1: 属性バイト（背景色と前景色）

### printk書式指定

サポートされている書式指定子：
- `%d`, `%i`: 符号付き整数
- `%u`: 符号なし整数
- `%x`, `%X`: 16進数
- `%s`: 文字列
- `%c`: 文字
- `%p`: ポインタ（16進数）

### シリアル出力

- COM1ポート（0x3F8）にも出力
- デバッグやログ記録に便利
